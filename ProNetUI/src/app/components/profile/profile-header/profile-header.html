<section class="card profile-header" aria-label="Profile header">
  <div class="banner" role="img" aria-label="Cover image"></div>
  <div class="header-inner">
     <!-- Edit pencil top right -->
  <button class="edit-btn-top-right" (click)="openEditModal()" aria-label="Edit profile header">✎</button>

    <!-- Trigger (profile image -> photo modal) -->
    <button
      class="profile-avatar-btn"
      (click)="openPhotoModal()"
      aria-label="Open profile photo"
    >
      <img
        class="avatar"
        [src]="photoSrc"
        (error)="useDefaultPhoto()"
        alt="Profile photo"
      />
    </button>

    <div class="identity">
    
      <div class="name">{{ firstName }} {{ lastName }}</div>
      <div class="headline">{{ headline }}</div>
      <div class="location">{{ city }}{{ city && state ? ', ' : '' }}{{ state }}{{ (city || state) && country ? ', ' : '' }}{{ country }}</div>
    </div>

    <div class="actions" aria-label="Profile actions">
      <button class="btn primary">Connect</button>
      <button class="btn-msg">Message</button>
      <button class="btn primary">More ▾</button>
    </div>
  </div>
</section>

<!-- ============ PHOTO MODAL ============ -->
<div
  class="modal"
  *ngIf="photoModalOpen"
  role="dialog"
  aria-modal="true"
  aria-labelledby="photoModalTitle"
>
  <div class="modal-backdrop" (click)="closePhotoModal()"></div>

  <div class="modal-content" (click)="$event.stopPropagation()">
    <button class="modal-close" (click)="closePhotoModal()" aria-label="Close">
      ×
    </button>

    <header class="modal-header">
      <h2 id="photoModalTitle">Profile photo</h2>
    </header>

    <div class="modal-body">
      <img class="modal-avatar" [src]="photoSrc" alt="Profile preview" />
    </div>

    <footer class="modal-actions">
      <button class="btn" (click)="fileInput.click()">Upload</button>
      <button class="btn danger" (click)="onDelete()">Delete</button>
      <button class="btn primary" (click)="onSave()">Save</button>
    </footer>
  </div>
</div>

<!-- Hidden file input for photo upload -->
<input
  type="file"
  accept="image/*"
  hidden
  #fileInput
  (change)="onFileSelected($event)"
/>

<!-- ============ EDIT PROFILE HEADER MODAL ============ -->
<div
  class="modal"
  *ngIf="editModalOpen"
  role="dialog"
  aria-modal="true"
  aria-labelledby="editProfileHeaderTitle"
>
  <div class="modal-backdrop" (click)="closeEditModal()"></div>

  <div class="modal-content large" (click)="$event.stopPropagation()">
    <button class="modal-close" (click)="closeEditModal()" aria-label="Close">×</button>

    <header class="modal-header">
      <h2 id="editProfileHeaderTitle">Edit profile</h2>
    </header>

    <form class="modal-body" (ngSubmit)="saveProfileHeader()" #editForm="ngForm">
      <!-- Basic info -->
      <fieldset class="section">
        <legend>Basic info</legend>
        <div class="grid grid-2">
          <label class="field">
            <span>First name</span>
            <input type="text" [(ngModel)]="firstName" name="firstName" placeholder="First name" />
          </label>
          <label class="field">
            <span>Last name</span>
            <input type="text" [(ngModel)]="lastName" name="lastName" placeholder="Last name" />
          </label>
        </div>
        <label class="field">
          <span>Headline</span>
          <input type="text" [(ngModel)]="headline" name="headline" placeholder="e.g., Software Engineer · Angular • Spring Boot • Postgres" />
        </label>
      </fieldset>

      <!-- Location -->
      <fieldset class="section">
        <legend>Location</legend>
        <div class="grid grid-3">
          <label class="field">
            <span>Country</span>
            <input type="text" [(ngModel)]="country" name="country" placeholder="United States" />
          </label>
          <label class="field">
            <span>State</span>
            <input type="text" [(ngModel)]="state" name="state" placeholder="Minnesota" />
          </label>
          <label class="field">
            <span>City</span>
            <input type="text" [(ngModel)]="city" name="city" placeholder="Minneapolis" />
          </label>
        </div>
      </fieldset>

      <!-- Contact -->
      <fieldset class="section">
        <legend>Contact info</legend>
        <div class="grid grid-3">
          <label class="field">
            <span>Phone</span>
            <input type="tel" [(ngModel)]="phone" name="phone" placeholder="+1 (555) 555‑5555" />
          </label>
          <label class="field">
            <span>Email</span>
            <input type="email" [(ngModel)]="email" name="email" placeholder="name@example.com" />
          </label>
          <label class="field">
            <span>LinkedIn</span>
            <input type="url" [(ngModel)]="linkedin" name="linkedin" placeholder="https://linkedin.com/in/username" />
          </label>
        </div>
      </fieldset>
    </form>

    <footer class="modal-actions">
      <button class="btn ghost" type="button" (click)="closeEditModal()">Cancel</button>
      <!-- <button class="btn" type="button" (click)="saveProfileHeader()">Save as draft</button> -->
      <button class="btn primary" type="submit" (click)="saveProfileHeader()">Save</button>
    </footer>
  </div>
</div>
